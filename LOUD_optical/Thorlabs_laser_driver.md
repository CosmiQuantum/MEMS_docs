# Thorlabs Laser System

**Laser system documentation also exists on the [QSC confluence page](https://confluence.qscience.org/display/1HTCSA/Thorlabs+Laser+System).  I am copying it here for the sake of completion and share-ability.**

### Commercial Parts
Laser Driver: https://www.thorlabs.com/newgrouppage9.cfm?objectgroup_id=7752&pn=CLD1010LP

Laser Diode: https://www.thorlabs.com/thorproduct.cfm?partnumber=LPS-635-FC

### Laser Desription
The laser operates in two mode: CW and pulsed.  A physical hardware change is required to switch the driver between these modes.  This project operates exclusively in the pulsed mode.

While operating in pulsed mode, the laser driver outputs a current of  $I = I_0 + I_{mod}$.  Where:
  * $I$ is the output current, seen by the laser diode
  * $I_0$ is an offset current applied by the driver
  * $I_{mod}$ is the RF modulation current.  This is provided via SMA input to the driver.  The SMA voltage input is converted to a current using the equation $I_{mod} = V_{mod} * 150 mA/V $

It is possible to control the Thorlabs driver remotely, but I have not yet explored this functionality.  **Instead, it was easier to keep the driver on 24/7 with the driver offset current $I_0$ set to 0V.**  This means that the current seen by the diode is generated entirely by the modulation voltage input; $I = V_{mod} * 150 mA/V $.  This input is generated by an AWG that we control remotely via ethernet commands.  

**To reiterate: we keep the laser driver on at all times, but with its output current set to 0mA.  The current through the laser diode is equal to this 0mA offset plus the RF "mod" input, which is provided by the AWG.  This configuration allows us to control the diode entirely using the AWG.**

The [laser diode datasheet is linked here](https://github.com/CosmiQuantum/MEMS_docs/blob/main/LOUD_optical/laser_diode_635nm.pdf)!!!  This gives us a maximum diode current of 59mA.  While setting up the driver, I did set a current limit.  But, I'm not sure this applies to the modulation input (and I don't want to test it).  So when we send AWG pulses, we need to be careful not to apply voltages greater than 0.39V.  Software controls should be put in place to prevent this. The AWG software code is designed to make it near-impossible for users to apply laser currents over 30mA.

### Recovering from power cycle
The laser driver should be kept on at all times but set to 0mA.  If, for some reason, it is turned off, this procedure can be used to reset things.
1. Ensure that silver key is inserted in the back of the driver, and turn it on.
2. Click "red" ``Laser Driver Setup`` button in top left and check settings:
| Setting    | Value |
| -------- | ------- |
| Laser Polarity | Anode Grounded (AG) |
| Laser Current Limit | 27.5mA |
| Operating Mode | Constant Current |
| Enable Noise Reduction Filter | no |
| Enable Modulation Input | yes |
| Switch Laser on When Starting | no |

Note that our maximum current is 59mA, so the current limit can be increased if needed.
3. Check that AWG is connected to laser driver RF mod input (SMA in back)
4. Set laser driver to 0mA.  Turn on TEC, then turn on laser output.  ***Note that this will give a “current underflow” warning message, but this is fine (since we’re using the AWG to supply current)***

### Diode Installation
These instructions live [on confluence](https://confluence.qscience.org/display/1HTCSA/Thorlabs+Laser+System) for now.  Maybe I'll post them here later.
